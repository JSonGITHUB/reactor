{"ast":null,"code":"var _jsxFileName = \"/Users/js/Dev/my-first-reactor/src/components/waves/Tide.js\";\nimport React, { useState, useEffect } from 'react';\nimport Loader from '../utils/Loader.js'; //import tide from '../../assets/images/tide.png'\n\nimport arrowDown from '../../assets/images/ArrowDown.png';\nimport arrowUp from '../../assets/images/ArrowUp.png';\n\nconst Tide = ({\n  setTide,\n  display,\n  isMotionOn\n}) => {\n  const previousTide = () => localStorage.getItem(\"tide\") ? Number(localStorage.getItem(\"tide\")) : 0;\n\n  const [status, setStatus] = useState({\n    station: null,\n    tide: null,\n    tideDirection: localStorage.tideDirection || \"?\",\n    height: null,\n    previousTide: null,\n    nextTide: null,\n    nextPhase: null,\n    nextTime: null,\n    untilNextTide: null\n  });\n\n  const getCurrentTime = () => {\n    let currentTime = new Date();\n    const year = currentTime.getFullYear();\n    const currentMonth = currentTime.getMonth() + 1;\n    const month = currentMonth < 10 ? `0${currentMonth}` : currentMonth;\n    const currentDate = currentTime.getDate();\n    const date = currentDate < 10 ? `0${currentDate}` : currentDate;\n    const currentHour = currentTime.getHours();\n    const hours = currentHour < 10 ? `0${currentHour}` : currentHour;\n    const startHour = currentHour - 1 < 10 ? `0${currentHour - 1}` : currentHour - 1;\n    const currentMinutes = currentTime.getMinutes();\n    const minutes = currentMinutes < 10 ? `0${currentMinutes}` : currentMinutes;\n    const getEndTime = `${year}${month}${date}%20${hours}:${minutes}`;\n    const getStartTime = `${year}${month}${date}%20${startHour}:00`;\n    currentTime = `${year}${month}${date}%20${hours}:${minutes}`;\n    return {\n      hours,\n      minutes,\n      date,\n      month,\n      year,\n      currentTime,\n      startTime: getStartTime,\n      endTime: getEndTime\n    };\n  };\n\n  const getTideData = () => {\n    console.log(`getTideData ->`);\n    let data;\n\n    const returnJSON = response => response.json();\n\n    const returnRejection = response => Promise.reject({\n      status: response.status,\n      data\n    });\n\n    const validate = response => response.ok ? returnJSON(response) : returnRejection(response);\n\n    console.log(`Tide   - getStartTime: ${getCurrentTime().startTime} => getEndTime: ${getCurrentTime().endTime}`);\n    const uriMLLW = `https://tidesandcurrents.noaa.gov/api/datagetter?begin_date=${getCurrentTime().startTime}&end_date=${getCurrentTime().endTime}&station=9410230&product=water_level&datum=mllw&units=english&time_zone=lst_ldt&application=web_services&format=json`;\n    const uriMHHW = `https://tidesandcurrents.noaa.gov/api/datagetter?begin_date=${getCurrentTime().currentTime}&end_date=${getCurrentTime().currentTime}&station=9410230&product=water_level&datum=MHHW&units=english&time_zone=lst_ldt&application=web_services&format=json`;\n    const uriMHW = `https://tidesandcurrents.noaa.gov/api/datagetter?begin_date=${getCurrentTime().currentTime}&end_date=${getCurrentTime().currentTime}&station=9410230&product=water_level&datum=MHW&units=english&time_zone=lst_ldt&application=web_services&format=json`;\n    const uriMTL = `https://tidesandcurrents.noaa.gov/api/datagetter?begin_date=${getCurrentTime().currentTime}&end_date=${getCurrentTime().currentTime}&station=9410230&product=water_level&datum=MTL&units=english&time_zone=lst_ldt&application=web_services&format=json`;\n    const uriMSL = `https://tidesandcurrents.noaa.gov/api/datagetter?begin_date=${getCurrentTime().currentTime}&end_date=${getCurrentTime().currentTime}&station=9410230&product=water_level&datum=MSL&units=english&time_zone=lst_ldt&application=web_services&format=json`;\n    const uriNAVD = `https://tidesandcurrents.noaa.gov/api/datagetter?begin_date=${getCurrentTime().currentTime}&end_date=${getCurrentTime().currentTime}&station=9410230&product=water_level&datum=NAVD&units=english&time_zone=lst_ldt&application=web_services&format=json`;\n    const uriSTND = `https://tidesandcurrents.noaa.gov/api/datagetter?begin_date=${getCurrentTime().currentTime}&end_date=${getCurrentTime().currentTime}&station=9410230&product=water_level&datum=STND&units=english&time_zone=lst_ldt&application=web_services&format=json`;\n    const uriLaJolla = `https://tidesandcurrents.noaa.gov/api/datagetter?product=predictions&amp;application=NOS.COOPS.TAC.WL&amp;begin_date=20201020&amp;end_date=20201021&amp;datum=MLLW&amp;station=9410230&amp;time_zone=lst_ldt&amp;units=english&amp;interval=hilo&amp;format=json`;\n    const uri = uriMLLW;\n    const proxyurl = \"https://cors-anywhere.herokuapp.com/\";\n\n    const parseTideData = data => {\n      const waterLevel = Number(data.data[data.data.length - 1].v).toFixed(1) || 1;\n      console.log(`tideData => ${JSON.stringify(data, null, 2)}`);\n      setTide(waterLevel);\n      setStatus({\n        station: data.metadata.name,\n        tide: waterLevel > 3 ? \"high\" : waterLevel < 2 ? \"low\" : \"medium\",\n        tideDirection: localStorage.tideDirection || \"?\",\n        height: status.height,\n        previousTide: previousTide(),\n        nextTide: status.nextnextTide,\n        nextPhase: status.nextPhase,\n        nextTime: status.nextTime,\n        untilNextTide: status.untilNextTide\n      });\n    };\n\n    const getTideHour = tide => Number(tide.t.split(\" \")[1].split(\":\")[0]);\n\n    const getTideMinutes = tide => Number(tide.t.split(\" \")[1].split(\":\")[1]); //        const getTideTime = (tide) => (getTideHour(tide) === getCurrentTime().hours) ? getTideHour(tide) : tide;\n\n\n    const getTideTime = tide => `${getTideHour(tide)}:${getTideMinutes(tide)}`;\n\n    const getTideHeight = tide => Number(tide.v); //const waterTempuri = `https://tidesandcurrents.noaa.gov/api/datagetter?begin_date=${getCurrentTime().currentTime}&end_date=${getCurrentTime().currentTime}&station=9410230&product=water_temperature&datum=mllw&units=english&time_zone=gmt&application=web_services&format=json`;\n\n\n    fetch(proxyurl + uri).then(response => validate(response)).then(data => {\n      console.log(`tideData => ${JSON.stringify(data, null, 2)} \\ncurrentTime: ${getCurrentTime().hours}:${getCurrentTime().minutes}`);\n      const waterLevel = Number(data.data[data.data.length - 1].v).toFixed(1);\n      setTide(waterLevel);\n      setStatus({\n        station: data.metadata.name,\n        tide: waterLevel > 3 ? \"high\" : waterLevel < 2 ? \"low\" : \"medium\",\n        tideDirection: localStorage.tideDirection || \"?\",\n        height: waterLevel,\n        previousTide: previousTide(),\n        nextTide: status.nextnextTide,\n        nextPhase: status.nextPhase,\n        nextTime: status.nextTime,\n        untilNextTide: status.untilNextTide\n      });\n    }).catch(err => console.log(`Something went wrong!\\nuri: ${uri} \\npath: ${window.location.pathname}\\n`, err));\n  };\n\n  const getDirection = () => {\n    console.log(`getDirection ->`);\n    let data;\n\n    const returnJSON = response => response.json();\n\n    const returnRejection = response => Promise.reject({\n      status: response.status,\n      data\n    });\n\n    const validate = response => response.ok ? returnJSON(response) : returnRejection(response);\n\n    console.log(`Tide   - getStartTime: ${getCurrentTime().startTime} => getEndTime: ${getCurrentTime().endTime}`);\n    const tideDaily = `https://api.tidesandcurrents.noaa.gov/api/prod/datagetter?product=predictions&amp;application=NOS.COOPS.TAC.WL&amp;begin_date=${getCurrentTime().year}${getCurrentTime().month}${getCurrentTime().date}&amp;end_date=${getCurrentTime().year}${getCurrentTime().month}${getCurrentTime().date}&amp;datum=MLLW&amp;station=9410230&amp;time_zone=lst_ldt&amp;units=english&amp;interval=hilo&amp;format=json`;\n    const uri = tideDaily;\n    const proxyurl = \"https://cors-anywhere.herokuapp.com/\";\n    console.log(`tideDaily: ${tideDaily}`);\n\n    const getTideHour = tide => Number(tide.t.split(\" \")[1].split(\":\")[0]);\n\n    const getTideMinutes = tide => Number(tide.t.split(\" \")[1].split(\":\")[1]); //        const getTideTime = (tide) => (getTideHour(tide) === getCurrentTime().hours) ? getTideHour(tide) : tide;\n\n\n    const getTideTime = tide => `${getTideHour(tide)}:${getTideMinutes(tide)}`;\n\n    const getTideHeight = tide => Number(tide.v);\n\n    const getTide = tide => tide.type; //const waterTempuri = `https://tidesandcurrents.noaa.gov/api/datagetter?begin_date=${getCurrentTime().currentTime}&end_date=${getCurrentTime().currentTime}&station=9410230&product=water_temperature&datum=mllw&units=english&time_zone=gmt&application=web_services&format=json`;\n\n\n    fetch(uri).then(response => validate(response)).then(data => {\n      console.log(`tideDirection => ${JSON.stringify(data, null, 2)}`);\n      const hours = data.predictions.map(tide => getTideHour(tide));\n      const times = data.predictions.map(tide => getTideTime(tide));\n      const heights = data.predictions.map(tide => getTideHeight(tide));\n      const tides = data.predictions.map(tide => getTide(tide));\n\n      const checkTide = hour => hour >= getCurrentTime().hours;\n\n      const nextTideIndex = hours.findIndex(checkTide);\n      const pastLastTide = Number(getCurrentTime().hours - hours[nextTideIndex - 1]);\n      const untilNextTide = Number(hours[nextTideIndex] - getCurrentTime().hours);\n      const untilNextTideMinutes = Number(hours[nextTideIndex] - getCurrentTime().hours);\n      const closerTideIndex = pastLastTide >= untilNextTide ? nextTideIndex : nextTideIndex - 1;\n      const nextTide = tides[nextTideIndex];\n      const nextHeight = heights[nextTideIndex];\n      const lastHeight = heights[nextTideIndex - 1];\n      const nextHour = Number(times[nextTideIndex].split(':')[0]) > 12 ? Number(times[nextTideIndex].split(':')[0]) - 12 : Number(times[nextTideIndex].split(':')[0]);\n      const nextMinutes = times[nextTideIndex].split(':')[1] < 10 ? `0${times[nextTideIndex].split(':')[1]}` : times[nextTideIndex].split(':')[1];\n      const nextTime = `${nextHour}:${nextMinutes}`;\n      const lastTide = tides[nextTideIndex - 1];\n\n      const convertTide = tide => tide === 'L' ? 'low' : 'high';\n\n      const getCurrentTide = convertTide(tides[closerTideIndex]);\n      const currentTide = pastLastTide !== untilNextTide ? getCurrentTide : 'medium';\n      console.log(`CURRENT ${currentTide} HOUR: ${getCurrentTime().hours} TIMES: ${hours}\\n next ${nextTide} tide in ${untilNextTide} hours\\n previous ${lastTide} tide was ${pastLastTide} hours ago tideMinutes: ${getCurrentTime().minutes}`);\n      setStatus({\n        station: status.station,\n        tide: currentTide,\n        tideDirection: nextTide === 'L' ? \"DOWN\" : \"UP\",\n        height: status.height,\n        previousTide: lastHeight,\n        nextTide: nextHeight,\n        nextPhase: convertTide(nextTide),\n        nextTime: nextTime,\n        untilNextTide\n      });\n    }).catch(err => console.log(`Something went wrong!\\nuri: ${uri} \\npath: ${window.location.pathname}\\n`, err));\n  };\n\n  const getAllData = () => {\n    getTideData();\n    getDirection();\n  };\n\n  useEffect(() => {\n    getAllData();\n    const timerID = setInterval(() => getAllData(), 300000);\n    return function cleanUp() {\n      clearInterval(timerID);\n    };\n  }, []);\n\n  const notEqual = () => Number(previousTide()) !== Number(status.height) ? true : false;\n\n  const greaterThan = () => Number(previousTide()) > Number(status.height) ? true : false;\n\n  const getDownArrow = () => {\n    localStorage.setItem(\"tideDirection\", \"DOWN\");\n    return /*#__PURE__*/React.createElement(\"img\", {\n      className: \"arrows mb--2\",\n      src: arrowDown,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 16\n      }\n    });\n  };\n\n  const getUpArrow = () => {\n    localStorage.setItem(\"tideDirection\", \"UP\");\n    return /*#__PURE__*/React.createElement(\"img\", {\n      className: \"arrows mb--2\",\n      src: arrowUp,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 16\n      }\n    });\n  };\n\n  const getTideDirection = () => status.tideDirection === \"DOWN\" ? getDownArrow() : getUpArrow(); //getTideDirection = () => (notEqual() && greaterThan()) ? \"DOWN\" : state.tideDirection;\n\n\n  const setLocalTide = () => localStorage.setItem(\"tide\", Number(status.height));\n\n  const setLocalTideDirection = () => localStorage.setItem(\"tideDirection\", status.tideDirection);\n\n  const fixHours = () => getCurrentTime().hours > 12 ? Number(getCurrentTime().hours - 12) : getCurrentTime().hours;\n\n  const getCurrentTide = () => /*#__PURE__*/React.createElement(\"div\", {\n    className: \"r-10 m-5 p-10 bg-lite white\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 34\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 29\n    }\n  }, getTideDirection()), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 29\n    }\n  }, status.height, \" \", /*#__PURE__*/React.createElement(\"span\", {\n    className: \"greet\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 50\n    }\n  }, \" ft. \"), status.tide), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"description pt-10\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 29\n    }\n  }, \"from: \", /*#__PURE__*/React.createElement(\"span\", {\n    className: \"greet bold\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 39\n    }\n  }, status.previousTide ? status.previousTide.toFixed(1) : '', \"' \"), display === 'narrow' ? /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 59\n    }\n  }) : '', \"to: \", /*#__PURE__*/React.createElement(\"span\", {\n    className: \"greet bold\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 74\n    }\n  }, status.nextTide ? status.nextTide.toFixed(1) : '', \"'\"), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 164\n    }\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"greet bold\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 33\n    }\n  }, status.nextPhase, \" in \", status.untilNextTide, \" \", display === 'narrow' ? 'hr' : 'hour', status.untilNextTide === 1 ? '' : 's', \" \"), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 194\n    }\n  }), \"at: \", /*#__PURE__*/React.createElement(\"span\", {\n    className: \"greet bold\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 37\n    }\n  }, status.nextTime)));\n\n  const percent = 'twentyfivePercent mt--70 mb--70';\n\n  const loading = () => /*#__PURE__*/React.createElement(\"div\", {\n    className: percent,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 27\n    }\n  }, /*#__PURE__*/React.createElement(Loader, {\n    isMotionOn: isMotionOn,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 211,\n      columnNumber: 25\n    }\n  })); //console.log(`tide direction: ${tideDirection} previous height: ${previousTide()} height: ${height} == ${previousTide() === Number(height)}`)\n\n\n  setLocalTide();\n  setLocalTideDirection();\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 12\n    }\n  }, getCurrentTide());\n};\n\nexport default Tide;\n/*   sample url data\n{\n    \"metadata\": {\n        \"id\":\"8454000\",\n        \"name\":\"Providence\",\n        \"lat\":\"41.8071\",\n        \"lon\":\"-71.4012\"\n    }, \n    \"data\": [\n        {\n            \"t\":\"2013-01-01 10:00\", \n            \"v\":\"0.072\", \n            \"s\":\"0.003\", \n            \"f\":\"0,0,0,0\", \n            \"q\":\"v\"\n        },\n        {\n            \"t\":\"2013-01-01 10:06\", \n            \"v\":\"0.095\", \n            \"s\":\"0.003\", \n            \"f\":\"0,0,0,0\", \n            \"q\":\"v\"\n        },\n        {\n            \"t\":\"2013-01-01 10:12\", \n            \"v\":\"0.115\", \n            \"s\":\"0.003\", \n            \"f\":\"0,0,0,0\", \n            \"q\":\"v\"\n        },\n        {\n            \"t\":\"2013-01-01 10:18\", \n            \"v\":\"0.138\", \n            \"s\":\"0.004\", \n            \"f\":\"0,0,0,0\", \n            \"q\":\"v\"\n        },\n        {\n            \"t\":\"2013-01-01 10:24\", \n            \"v\":\"0.167\", \n            \"s\":\"0.004\", \n            \"f\":\"0,0,0,0\", \n            \"q\":\"v\"\n        }\n    ]\n}\n*/\n\n/* Sample temp data\nmetadata\":{\n    \"id\":\"8454000\",\n    \"name\":\"Providence\",\n    \"lat\":\"41.8071\",\n    \"lon\":\"-71.4012\"\n}, \n\"data\": [\n    {\n        \"t\":\"2013-08-08 15:00\", \n        \"v\":\"72.5\", \n        \"f\":\"0,0,0\"\n    },\n    {\n        \"t\":\"2013-08-08 15:06\", \n        \"v\":\"72.5\", \n        \"f\":\"0,0,0\"\n    }\n]\n}\n\nhttps://tidesandcurrents.noaa.gov/api/datagetter?\nbegin_date=20200520%2018:46&\nend_date=20200520%2018:46&\nstation=9410230&\nproduct=water_level&\ndatum=mllw&\nunits=english&\ntime_zone=gmt&\napplication=web_services&\nformat=json\n\nhttps://tidesandcurrents.noaa.gov/api/datagetter?\nbegin_date=20200520%2018:24&\nend_date=20200520%2018:24&\nstation=9410230&\nproduct=water_level&\ndatum=mllw&\nunits=english&\ntime_zone=gmt&\napplication=web_services&\nformat=json\n\n{\n    \"metadata\":{\n        \"id\":\"9410230\",\n        \"name\":\"La Jolla\",\n        \"lat\":\"32.8669\",\n        \"lon\":\"-117.2571\"\n    }, \n    \"data\": [\n        {\n            \"t\":\"2020-05-20 18:24\", \n            \"v\":\"2.494\", \n            \"s\":\"0.459\", \n            \"f\":\"0,0,0,0\", \n            \"q\":\"p\"\n        }\n    ]\n}\n*/","map":{"version":3,"sources":["/Users/js/Dev/my-first-reactor/src/components/waves/Tide.js"],"names":["React","useState","useEffect","Loader","arrowDown","arrowUp","Tide","setTide","display","isMotionOn","previousTide","localStorage","getItem","Number","status","setStatus","station","tide","tideDirection","height","nextTide","nextPhase","nextTime","untilNextTide","getCurrentTime","currentTime","Date","year","getFullYear","currentMonth","getMonth","month","currentDate","getDate","date","currentHour","getHours","hours","startHour","currentMinutes","getMinutes","minutes","getEndTime","getStartTime","startTime","endTime","getTideData","console","log","data","returnJSON","response","json","returnRejection","Promise","reject","validate","ok","uriMLLW","uriMHHW","uriMHW","uriMTL","uriMSL","uriNAVD","uriSTND","uriLaJolla","uri","proxyurl","parseTideData","waterLevel","length","v","toFixed","JSON","stringify","metadata","name","nextnextTide","getTideHour","t","split","getTideMinutes","getTideTime","getTideHeight","fetch","then","catch","err","window","location","pathname","getDirection","tideDaily","getTide","type","predictions","map","times","heights","tides","checkTide","hour","nextTideIndex","findIndex","pastLastTide","untilNextTideMinutes","closerTideIndex","nextHeight","lastHeight","nextHour","nextMinutes","lastTide","convertTide","getCurrentTide","currentTide","getAllData","timerID","setInterval","cleanUp","clearInterval","notEqual","greaterThan","getDownArrow","setItem","getUpArrow","getTideDirection","setLocalTide","setLocalTideDirection","fixHours","percent","loading"],"mappings":"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AA,SAAS,EAAED,OAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACF,oBAAC,MAAD;AAAQ,IAAA,UAAU,EAAExH,UAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADE,CAAtB,CA3M6C,CA+M7C;;;AACAqH,EAAAA,YAAY;AACZC,EAAAA,qBAAqB;AACrB,sBAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAMd,cAAc,EAApB,CAAP;AACH,CAnND;;AAqNA,eAAe3G,IAAf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport Loader from '../utils/Loader.js';\n//import tide from '../../assets/images/tide.png'\nimport arrowDown from '../../assets/images/ArrowDown.png';\nimport arrowUp from '../../assets/images/ArrowUp.png';\n\nconst Tide = ({setTide, display, isMotionOn}) => {\n    const previousTide = () => (localStorage.getItem(\"tide\")) ? Number(localStorage.getItem(\"tide\")) : 0;\n    const [status, setStatus] = useState({\n        station: null,\n        tide: null,\n        tideDirection: localStorage.tideDirection || \"?\",\n        height: null,\n        previousTide: null,\n        nextTide: null,\n        nextPhase: null,\n        nextTime: null,\n        untilNextTide: null\n    });\n    const getCurrentTime = () => {\n        let currentTime = new Date();\n        const year = currentTime.getFullYear();\n        const currentMonth = currentTime.getMonth()+1;\n        const month = ((currentMonth)<10) ? `0${(currentMonth)}` : currentMonth;\n        const currentDate = currentTime.getDate();\n        const date = (currentDate<10) ? `0${currentDate}` : currentDate;\n        const currentHour = currentTime.getHours();\n        const hours = (currentHour<10) ? `0${currentHour}` : currentHour;\n        const startHour = ((currentHour-1)<10) ? `0${(currentHour-1)}` : (currentHour-1);\n        const currentMinutes = currentTime.getMinutes();\n        const minutes = (currentMinutes<10) ? `0${currentMinutes}` : currentMinutes;\n        const getEndTime = `${year}${month}${date}%20${hours}:${minutes}`;\n        const getStartTime = `${year}${month}${date}%20${startHour}:00`;\n        currentTime = `${year}${month}${date}%20${hours}:${minutes}`;\n        return (\n            {   \n                hours,\n                minutes,\n                date,\n                month,\n                year,\n                currentTime,\n                startTime: getStartTime,\n                endTime: getEndTime\n            }\n        )\n    }\n    const getTideData = () => {\n        console.log(`getTideData ->`);\n        let data;\n        const returnJSON = (response) => response.json();\n        const returnRejection = (response) => Promise.reject({status: response.status, data});\n        const validate = (response) => (response.ok) ? returnJSON(response) : returnRejection(response);\n        \n        console.log(`Tide   - getStartTime: ${getCurrentTime().startTime} => getEndTime: ${getCurrentTime().endTime}`)\n        const uriMLLW = `https://tidesandcurrents.noaa.gov/api/datagetter?begin_date=${getCurrentTime().startTime}&end_date=${getCurrentTime().endTime}&station=9410230&product=water_level&datum=mllw&units=english&time_zone=lst_ldt&application=web_services&format=json`;\n        const uriMHHW = `https://tidesandcurrents.noaa.gov/api/datagetter?begin_date=${getCurrentTime().currentTime}&end_date=${getCurrentTime().currentTime}&station=9410230&product=water_level&datum=MHHW&units=english&time_zone=lst_ldt&application=web_services&format=json`;\n        const uriMHW = `https://tidesandcurrents.noaa.gov/api/datagetter?begin_date=${getCurrentTime().currentTime}&end_date=${getCurrentTime().currentTime}&station=9410230&product=water_level&datum=MHW&units=english&time_zone=lst_ldt&application=web_services&format=json`;\n        const uriMTL = `https://tidesandcurrents.noaa.gov/api/datagetter?begin_date=${getCurrentTime().currentTime}&end_date=${getCurrentTime().currentTime}&station=9410230&product=water_level&datum=MTL&units=english&time_zone=lst_ldt&application=web_services&format=json`;\n        const uriMSL = `https://tidesandcurrents.noaa.gov/api/datagetter?begin_date=${getCurrentTime().currentTime}&end_date=${getCurrentTime().currentTime}&station=9410230&product=water_level&datum=MSL&units=english&time_zone=lst_ldt&application=web_services&format=json`;\n        const uriNAVD = `https://tidesandcurrents.noaa.gov/api/datagetter?begin_date=${getCurrentTime().currentTime}&end_date=${getCurrentTime().currentTime}&station=9410230&product=water_level&datum=NAVD&units=english&time_zone=lst_ldt&application=web_services&format=json`;\n        const uriSTND = `https://tidesandcurrents.noaa.gov/api/datagetter?begin_date=${getCurrentTime().currentTime}&end_date=${getCurrentTime().currentTime}&station=9410230&product=water_level&datum=STND&units=english&time_zone=lst_ldt&application=web_services&format=json`;\n        const uriLaJolla = `https://tidesandcurrents.noaa.gov/api/datagetter?product=predictions&amp;application=NOS.COOPS.TAC.WL&amp;begin_date=20201020&amp;end_date=20201021&amp;datum=MLLW&amp;station=9410230&amp;time_zone=lst_ldt&amp;units=english&amp;interval=hilo&amp;format=json`;\n        const uri = uriMLLW;\n        const proxyurl = \"https://cors-anywhere.herokuapp.com/\";\n        const parseTideData = (data) => {\n            const waterLevel = Number(data.data[data.data.length - 1].v).toFixed(1) || 1;\n            console.log(`tideData => ${JSON.stringify(data, null, 2)}`);\n            setTide(waterLevel);\n            setStatus({\n                station: data.metadata.name,\n                tide:(waterLevel > 3) ? \"high\" : (waterLevel < 2) ? \"low\" : \"medium\",\n                tideDirection: localStorage.tideDirection || \"?\",\n                height: status.height,\n                previousTide: previousTide(),\n                nextTide: status.nextnextTide,\n                nextPhase: status.nextPhase,\n                nextTime: status.nextTime,\n                untilNextTide: status.untilNextTide\n            });\n        }\n        const getTideHour = (tide) => Number(tide.t.split(\" \")[1].split(\":\")[0]);\n        const getTideMinutes = (tide) => Number(tide.t.split(\" \")[1].split(\":\")[1]);\n//        const getTideTime = (tide) => (getTideHour(tide) === getCurrentTime().hours) ? getTideHour(tide) : tide;\n        const getTideTime = (tide) => `${getTideHour(tide)}:${getTideMinutes(tide)}`;\n        const getTideHeight = (tide) => Number(tide.v);\n        //const waterTempuri = `https://tidesandcurrents.noaa.gov/api/datagetter?begin_date=${getCurrentTime().currentTime}&end_date=${getCurrentTime().currentTime}&station=9410230&product=water_temperature&datum=mllw&units=english&time_zone=gmt&application=web_services&format=json`;\n        fetch(proxyurl + uri)\n            .then(response => validate(response))\n            .then(data => {\n                console.log(`tideData => ${JSON.stringify(data, null, 2)} \\ncurrentTime: ${getCurrentTime().hours}:${getCurrentTime().minutes}`);\n                const waterLevel = Number(data.data[data.data.length - 1].v).toFixed(1);\n                setTide(waterLevel);\n                setStatus({\n                    station: data.metadata.name,\n                    tide:(waterLevel > 3) ? \"high\" : (waterLevel < 2) ? \"low\" : \"medium\",\n                    tideDirection: localStorage.tideDirection || \"?\",\n                    height: waterLevel,\n                    previousTide: previousTide(),\n                    nextTide: status.nextnextTide,\n                    nextPhase: status.nextPhase,\n                    nextTime: status.nextTime,\n                    untilNextTide: status.untilNextTide\n                });\n            })\n            .catch(err => console.log(`Something went wrong!\\nuri: ${uri} \\npath: ${window.location.pathname}\\n`, err));\n\n    }\n    const getDirection = () => {\n        console.log(`getDirection ->`);\n        let data;\n        const returnJSON = (response) => response.json();\n        const returnRejection = (response) => Promise.reject({status: response.status, data});\n        const validate = (response) => (response.ok) ? returnJSON(response) : returnRejection(response);\n        console.log(`Tide   - getStartTime: ${getCurrentTime().startTime} => getEndTime: ${getCurrentTime().endTime}`)\n        const tideDaily = `https://api.tidesandcurrents.noaa.gov/api/prod/datagetter?product=predictions&amp;application=NOS.COOPS.TAC.WL&amp;begin_date=${getCurrentTime().year}${getCurrentTime().month}${getCurrentTime().date}&amp;end_date=${getCurrentTime().year}${getCurrentTime().month}${getCurrentTime().date}&amp;datum=MLLW&amp;station=9410230&amp;time_zone=lst_ldt&amp;units=english&amp;interval=hilo&amp;format=json`;\n        const uri = tideDaily;\n        const proxyurl = \"https://cors-anywhere.herokuapp.com/\";\n        console.log(`tideDaily: ${tideDaily}`)\n        const getTideHour = (tide) => Number(tide.t.split(\" \")[1].split(\":\")[0]);\n        const getTideMinutes = (tide) => Number(tide.t.split(\" \")[1].split(\":\")[1]);\n//        const getTideTime = (tide) => (getTideHour(tide) === getCurrentTime().hours) ? getTideHour(tide) : tide;\n        const getTideTime = (tide) => `${getTideHour(tide)}:${getTideMinutes(tide)}`;\n        const getTideHeight = (tide) => Number(tide.v);\n        const getTide = (tide) => tide.type;\n        //const waterTempuri = `https://tidesandcurrents.noaa.gov/api/datagetter?begin_date=${getCurrentTime().currentTime}&end_date=${getCurrentTime().currentTime}&station=9410230&product=water_temperature&datum=mllw&units=english&time_zone=gmt&application=web_services&format=json`;\n        fetch(uri)\n            .then(response => validate(response))\n            .then(data => {\n                console.log(`tideDirection => ${JSON.stringify(data, null, 2)}`);\n                const hours = data.predictions.map((tide) => getTideHour(tide));\n                const times = data.predictions.map((tide) => getTideTime(tide));\n                const heights = data.predictions.map((tide) => getTideHeight(tide));\n                const tides = data.predictions.map((tide) => getTide(tide));\n                const checkTide = (hour) => hour >= getCurrentTime().hours;\n                const nextTideIndex = hours.findIndex(checkTide);\n                const pastLastTide = Number(getCurrentTime().hours-hours[nextTideIndex-1]);\n                const untilNextTide = Number(hours[nextTideIndex]-getCurrentTime().hours);\n                const untilNextTideMinutes = Number(hours[nextTideIndex]-getCurrentTime().hours);\n                const closerTideIndex = (pastLastTide >= untilNextTide) ? nextTideIndex : (nextTideIndex-1);\n                const nextTide = tides[nextTideIndex];\n                const nextHeight = heights[nextTideIndex];\n                const lastHeight = heights[nextTideIndex-1];\n                const nextHour = (Number(times[nextTideIndex].split(':')[0])>12) ? (Number(times[nextTideIndex].split(':')[0])-12) : Number(times[nextTideIndex].split(':')[0]);\n                const nextMinutes = (times[nextTideIndex].split(':')[1] < 10) ? `0${times[nextTideIndex].split(':')[1]}` : times[nextTideIndex].split(':')[1];\n                const nextTime = `${nextHour}:${nextMinutes}`;\n                const lastTide = tides[nextTideIndex-1];\n                const convertTide = (tide) => (tide === 'L') ? 'low' : 'high';\n                const getCurrentTide = convertTide(tides[closerTideIndex]);\n                const currentTide = ((pastLastTide !== untilNextTide)) ? getCurrentTide : 'medium';\n                console.log(`CURRENT ${currentTide} HOUR: ${getCurrentTime().hours} TIMES: ${hours}\\n next ${nextTide} tide in ${untilNextTide} hours\\n previous ${lastTide} tide was ${pastLastTide} hours ago tideMinutes: ${getCurrentTime().minutes}`);\n                setStatus({\n                    station: status.station,\n                    tide: currentTide,\n                    tideDirection: (nextTide === 'L') ? \"DOWN\" : \"UP\",\n                    height: status.height,\n                    previousTide: lastHeight,\n                    nextTide: nextHeight,\n                    nextPhase: convertTide(nextTide),\n                    nextTime: nextTime,\n                    untilNextTide\n                });\n            })\n            .catch(err => console.log(`Something went wrong!\\nuri: ${uri} \\npath: ${window.location.pathname}\\n`, err));\n\n    }\n    const getAllData = () => {\n        getTideData();\n        getDirection();\n    }\n    useEffect(() => {   \n        getAllData(); \t\t\n        const timerID = setInterval(\n            () => getAllData(),\n            300000\n        );\n        return function cleanUp () {\n            clearInterval(timerID);\n        }\n    }, []);\n\n    const notEqual = () => (Number(previousTide()) !== Number(status.height)) ? true : false;\n    const greaterThan = () => (Number(previousTide()) > Number(status.height)) ? true : false;\n    const getDownArrow = () => {\n        localStorage.setItem(\"tideDirection\", \"DOWN\")\n        return <img className='arrows mb--2' src={arrowDown} />\n    }\n    const getUpArrow = () => { \n        localStorage.setItem(\"tideDirection\", \"UP\")\n        return <img className='arrows mb--2' src={arrowUp} />\n    }\n    const getTideDirection = () => (status.tideDirection === \"DOWN\") ? getDownArrow() : getUpArrow();\n    //getTideDirection = () => (notEqual() && greaterThan()) ? \"DOWN\" : state.tideDirection;\n    const setLocalTide = () => localStorage.setItem(\"tide\", Number(status.height));\n    const setLocalTideDirection = () => localStorage.setItem(\"tideDirection\", status.tideDirection);\n    const fixHours = () => (getCurrentTime().hours>12) ? Number(getCurrentTime().hours - 12) : getCurrentTime().hours;\n\n    const getCurrentTide = () => <div className=\"r-10 m-5 p-10 bg-lite white\">\n                            <div>{getTideDirection()}</div>\n                            <div>{status.height} <span className=\"greet\"> ft. </span>{status.tide}</div>\n                            <div className='description pt-10'>\n                                from: <span className='greet bold'>{(status.previousTide) ? status.previousTide.toFixed(1) : ''}' </span>\n                                {(display === 'narrow') ? <br/> : ''}to: <span className='greet bold'>{(status.nextTide) ? status.nextTide.toFixed(1) : ''}'</span><br/>\n                                <span className='greet bold'>{status.nextPhase} in {status.untilNextTide} {(display === 'narrow') ? 'hr' : 'hour'}{status.untilNextTide === 1 ? '' : 's'} </span><br/>\n                                at: <span className='greet bold'>{status.nextTime}</span>\n                            </div>\n                        </div>;\n\n    const percent = 'twentyfivePercent mt--70 mb--70';\n    const loading = () => <div className={percent}>\n                        <Loader isMotionOn={isMotionOn}/>\n                    </div>;\n                    \n    //console.log(`tide direction: ${tideDirection} previous height: ${previousTide()} height: ${height} == ${previousTide() === Number(height)}`)\n    setLocalTide();\n    setLocalTideDirection();\n    return <div>{getCurrentTide()}</div>\n}\n\nexport default Tide;\n/*   sample url data\n{\n    \"metadata\": {\n        \"id\":\"8454000\",\n        \"name\":\"Providence\",\n        \"lat\":\"41.8071\",\n        \"lon\":\"-71.4012\"\n    }, \n    \"data\": [\n        {\n            \"t\":\"2013-01-01 10:00\", \n            \"v\":\"0.072\", \n            \"s\":\"0.003\", \n            \"f\":\"0,0,0,0\", \n            \"q\":\"v\"\n        },\n        {\n            \"t\":\"2013-01-01 10:06\", \n            \"v\":\"0.095\", \n            \"s\":\"0.003\", \n            \"f\":\"0,0,0,0\", \n            \"q\":\"v\"\n        },\n        {\n            \"t\":\"2013-01-01 10:12\", \n            \"v\":\"0.115\", \n            \"s\":\"0.003\", \n            \"f\":\"0,0,0,0\", \n            \"q\":\"v\"\n        },\n        {\n            \"t\":\"2013-01-01 10:18\", \n            \"v\":\"0.138\", \n            \"s\":\"0.004\", \n            \"f\":\"0,0,0,0\", \n            \"q\":\"v\"\n        },\n        {\n            \"t\":\"2013-01-01 10:24\", \n            \"v\":\"0.167\", \n            \"s\":\"0.004\", \n            \"f\":\"0,0,0,0\", \n            \"q\":\"v\"\n        }\n    ]\n}\n*/\n\n/* Sample temp data\nmetadata\":{\n    \"id\":\"8454000\",\n    \"name\":\"Providence\",\n    \"lat\":\"41.8071\",\n    \"lon\":\"-71.4012\"\n}, \n\"data\": [\n    {\n        \"t\":\"2013-08-08 15:00\", \n        \"v\":\"72.5\", \n        \"f\":\"0,0,0\"\n    },\n    {\n        \"t\":\"2013-08-08 15:06\", \n        \"v\":\"72.5\", \n        \"f\":\"0,0,0\"\n    }\n]\n}\n\nhttps://tidesandcurrents.noaa.gov/api/datagetter?\nbegin_date=20200520%2018:46&\nend_date=20200520%2018:46&\nstation=9410230&\nproduct=water_level&\ndatum=mllw&\nunits=english&\ntime_zone=gmt&\napplication=web_services&\nformat=json\n\nhttps://tidesandcurrents.noaa.gov/api/datagetter?\nbegin_date=20200520%2018:24&\nend_date=20200520%2018:24&\nstation=9410230&\nproduct=water_level&\ndatum=mllw&\nunits=english&\ntime_zone=gmt&\napplication=web_services&\nformat=json\n\n{\n    \"metadata\":{\n        \"id\":\"9410230\",\n        \"name\":\"La Jolla\",\n        \"lat\":\"32.8669\",\n        \"lon\":\"-117.2571\"\n    }, \n    \"data\": [\n        {\n            \"t\":\"2020-05-20 18:24\", \n            \"v\":\"2.494\", \n            \"s\":\"0.459\", \n            \"f\":\"0,0,0,0\", \n            \"q\":\"p\"\n        }\n    ]\n}\n*/"]},"metadata":{},"sourceType":"module"}