{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nconst as_promise_1 = require(\"./as-promise\");\n\nconst as_stream_1 = require(\"./as-stream\");\n\nconst errors = require(\"./errors\");\n\nconst normalize_arguments_1 = require(\"./normalize-arguments\");\n\nconst deep_freeze_1 = require(\"./utils/deep-freeze\");\n\nconst getPromiseOrStream = options => options.isStream ? as_stream_1.default(options) : as_promise_1.default(options);\n\nconst isGotInstance = value => Reflect.has(value, 'defaults') && Reflect.has(value.defaults, 'options');\n\nconst aliases = ['get', 'post', 'put', 'patch', 'head', 'delete'];\n\nexports.defaultHandler = (options, next) => next(options);\n\nconst create = defaults => {\n  // Proxy properties from next handlers\n  defaults._rawHandlers = defaults.handlers;\n  defaults.handlers = defaults.handlers.map(fn => (options, next) => {\n    // This will be assigned by assigning result\n    let root;\n    const result = fn(options, newOptions => {\n      root = next(newOptions);\n      return root;\n    });\n\n    if (result !== root && !options.isStream) {\n      Object.setPrototypeOf(result, Object.getPrototypeOf(root));\n      Object.defineProperties(result, Object.getOwnPropertyDescriptors(root));\n    }\n\n    return result;\n  }); // @ts-ignore Because the for loop handles it for us, as well as the other Object.defines\n\n  const got = (url, options) => {\n    var _a;\n\n    let iteration = 0;\n\n    const iterateHandlers = newOptions => {\n      return defaults.handlers[iteration++](newOptions, iteration === defaults.handlers.length ? getPromiseOrStream : iterateHandlers);\n    };\n    /* eslint-disable @typescript-eslint/return-await */\n\n\n    try {\n      return iterateHandlers(normalize_arguments_1.normalizeArguments(url, options, defaults));\n    } catch (error) {\n      if ((_a = options) === null || _a === void 0 ? void 0 : _a.isStream) {\n        throw error;\n      } else {\n        // @ts-ignore It's an Error not a response, but TS thinks it's calling .resolve\n        return as_promise_1.createRejection(error);\n      }\n    }\n    /* eslint-enable @typescript-eslint/return-await */\n\n  };\n\n  got.extend = (...instancesOrOptions) => {\n    const optionsArray = [defaults.options];\n    let handlers = [...defaults._rawHandlers];\n    let isMutableDefaults;\n\n    for (const value of instancesOrOptions) {\n      if (isGotInstance(value)) {\n        optionsArray.push(value.defaults.options);\n        handlers.push(...value.defaults._rawHandlers);\n        isMutableDefaults = value.defaults.mutableDefaults;\n      } else {\n        optionsArray.push(value);\n\n        if (Reflect.has(value, 'handlers')) {\n          handlers.push(...value.handlers);\n        }\n\n        isMutableDefaults = value.mutableDefaults;\n      }\n    }\n\n    handlers = handlers.filter(handler => handler !== exports.defaultHandler);\n\n    if (handlers.length === 0) {\n      handlers.push(exports.defaultHandler);\n    }\n\n    return create({\n      options: normalize_arguments_1.mergeOptions(...optionsArray),\n      handlers,\n      mutableDefaults: Boolean(isMutableDefaults)\n    });\n  }; // @ts-ignore The missing methods because the for-loop handles it for us\n\n\n  got.stream = (url, options) => got(url, { ...options,\n    isStream: true\n  });\n\n  for (const method of aliases) {\n    // @ts-ignore Cannot properly type a function with multiple definitions yet\n    got[method] = (url, options) => got(url, { ...options,\n      method\n    });\n\n    got.stream[method] = (url, options) => got.stream(url, { ...options,\n      method\n    });\n  }\n\n  Object.assign(got, { ...errors,\n    mergeOptions: normalize_arguments_1.mergeOptions\n  });\n  Object.defineProperty(got, 'defaults', {\n    value: defaults.mutableDefaults ? defaults : deep_freeze_1.default(defaults),\n    writable: defaults.mutableDefaults,\n    configurable: defaults.mutableDefaults,\n    enumerable: true\n  });\n  return got;\n};\n\nexports.default = create;","map":{"version":3,"sources":["/Users/js/Dev/my-first-reactor/node_modules/got/dist/source/create.js"],"names":["Object","defineProperty","exports","value","as_promise_1","require","as_stream_1","errors","normalize_arguments_1","deep_freeze_1","getPromiseOrStream","options","isStream","default","isGotInstance","Reflect","has","defaults","aliases","defaultHandler","next","create","_rawHandlers","handlers","map","fn","root","result","newOptions","setPrototypeOf","getPrototypeOf","defineProperties","getOwnPropertyDescriptors","got","url","_a","iteration","iterateHandlers","length","normalizeArguments","error","createRejection","extend","instancesOrOptions","optionsArray","isMutableDefaults","push","mutableDefaults","filter","handler","mergeOptions","Boolean","stream","method","assign","writable","configurable","enumerable"],"mappings":"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","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst as_promise_1 = require(\"./as-promise\");\nconst as_stream_1 = require(\"./as-stream\");\nconst errors = require(\"./errors\");\nconst normalize_arguments_1 = require(\"./normalize-arguments\");\nconst deep_freeze_1 = require(\"./utils/deep-freeze\");\nconst getPromiseOrStream = (options) => options.isStream ? as_stream_1.default(options) : as_promise_1.default(options);\nconst isGotInstance = (value) => (Reflect.has(value, 'defaults') && Reflect.has(value.defaults, 'options'));\nconst aliases = [\n    'get',\n    'post',\n    'put',\n    'patch',\n    'head',\n    'delete'\n];\nexports.defaultHandler = (options, next) => next(options);\nconst create = (defaults) => {\n    // Proxy properties from next handlers\n    defaults._rawHandlers = defaults.handlers;\n    defaults.handlers = defaults.handlers.map(fn => ((options, next) => {\n        // This will be assigned by assigning result\n        let root;\n        const result = fn(options, newOptions => {\n            root = next(newOptions);\n            return root;\n        });\n        if (result !== root && !options.isStream) {\n            Object.setPrototypeOf(result, Object.getPrototypeOf(root));\n            Object.defineProperties(result, Object.getOwnPropertyDescriptors(root));\n        }\n        return result;\n    }));\n    // @ts-ignore Because the for loop handles it for us, as well as the other Object.defines\n    const got = (url, options) => {\n        var _a;\n        let iteration = 0;\n        const iterateHandlers = (newOptions) => {\n            return defaults.handlers[iteration++](newOptions, iteration === defaults.handlers.length ? getPromiseOrStream : iterateHandlers);\n        };\n        /* eslint-disable @typescript-eslint/return-await */\n        try {\n            return iterateHandlers(normalize_arguments_1.normalizeArguments(url, options, defaults));\n        }\n        catch (error) {\n            if ((_a = options) === null || _a === void 0 ? void 0 : _a.isStream) {\n                throw error;\n            }\n            else {\n                // @ts-ignore It's an Error not a response, but TS thinks it's calling .resolve\n                return as_promise_1.createRejection(error);\n            }\n        }\n        /* eslint-enable @typescript-eslint/return-await */\n    };\n    got.extend = (...instancesOrOptions) => {\n        const optionsArray = [defaults.options];\n        let handlers = [...defaults._rawHandlers];\n        let isMutableDefaults;\n        for (const value of instancesOrOptions) {\n            if (isGotInstance(value)) {\n                optionsArray.push(value.defaults.options);\n                handlers.push(...value.defaults._rawHandlers);\n                isMutableDefaults = value.defaults.mutableDefaults;\n            }\n            else {\n                optionsArray.push(value);\n                if (Reflect.has(value, 'handlers')) {\n                    handlers.push(...value.handlers);\n                }\n                isMutableDefaults = value.mutableDefaults;\n            }\n        }\n        handlers = handlers.filter(handler => handler !== exports.defaultHandler);\n        if (handlers.length === 0) {\n            handlers.push(exports.defaultHandler);\n        }\n        return create({\n            options: normalize_arguments_1.mergeOptions(...optionsArray),\n            handlers,\n            mutableDefaults: Boolean(isMutableDefaults)\n        });\n    };\n    // @ts-ignore The missing methods because the for-loop handles it for us\n    got.stream = (url, options) => got(url, { ...options, isStream: true });\n    for (const method of aliases) {\n        // @ts-ignore Cannot properly type a function with multiple definitions yet\n        got[method] = (url, options) => got(url, { ...options, method });\n        got.stream[method] = (url, options) => got.stream(url, { ...options, method });\n    }\n    Object.assign(got, { ...errors, mergeOptions: normalize_arguments_1.mergeOptions });\n    Object.defineProperty(got, 'defaults', {\n        value: defaults.mutableDefaults ? defaults : deep_freeze_1.default(defaults),\n        writable: defaults.mutableDefaults,\n        configurable: defaults.mutableDefaults,\n        enumerable: true\n    });\n    return got;\n};\nexports.default = create;\n"]},"metadata":{},"sourceType":"script"}