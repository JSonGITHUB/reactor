{"ast":null,"code":"import _regeneratorRuntime from\"/Users/js/Dev/my-first-reactor/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"/Users/js/Dev/my-first-reactor/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/Users/js/Dev/my-first-reactor/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/js/Dev/my-first-reactor/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useState}from\"react\";import axios from\"axios\";import useCurrentTime from\"../utils/useCurrentTime.js\";var useOceanData=function useOceanData(component,uri){var _useState=useState({oceanData:{},updated:false}),_useState2=_slicedToArray(_useState,2),status=_useState2[0],setStatus=_useState2[1];var date=useCurrentTime()[0].startTime.split(\"%\")[0];var getOceanData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _yield$axios$get,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:console.log(\"getOceanData => SERVER: \".concat(component));//console.log(`getOceanData => SERVER: ${component}\\nuri: ${uri}`);\n_context.next=3;return axios.get(uri,{params:{origin:\"*\",format:\"json\",mode:\"cors\"}});case 3:_yield$axios$get=_context.sent;data=_yield$axios$get.data;//console.log(`getOceanData => SERVER: ${component}: \\nstatus.updated: ${status.updated}\\nuri: ${uri}\\noceanData: ${JSON.stringify(data, null, 2)}`)\n//console.log(`getOceanData => data.data: ${JSON.stringify(data.data, null, 2)}`)\n//const lastElement = data.data[data.data.length-1];\n//console.log(`getOceanData => data.data[last]: ${JSON.stringify(lastElement)}`)\n//console.log(`getOceanData => data.data[last].v: ${lastElement.v}`)\n//console.log(`getOceanData => data.data[last].dr: ${lastElement.dr}`)\n//console.log(`getOceanData => data.data[last].t: ${lastElement.t}`)\n//console.log(`getOceanData => data.data[last].d: ${lastElement.d}`)\n//console.log(`getOceanData => data.data[last].g: ${lastElement.g}`)\nlocalStorage.setItem(\"\".concat(component,\"Data\"),JSON.stringify(data));localStorage.setItem(\"\".concat(component,\"Date\"),date);setStatus(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{oceanData:data,update:true});});case 8:case\"end\":return _context.stop();}},_callee);}));return function getOceanData(){return _ref.apply(this,arguments);};}();useEffect(function(){//console.log(`OceanData => ${ component }`)\nvar ignore=false;//console.log(`useOceanData => CHECK\\nstatus.oceanData: ${JSON.stringify(status.oceanData,null,2)}\\ndate: ${date}`)\nif(!ignore&&JSON.stringify(status.oceanData)===\"{}\"){getOceanData();}return function(){ignore=true;};},[]);return[status.oceanData,getOceanData];};export default useOceanData;","map":{"version":3,"names":["useEffect","useState","axios","useCurrentTime","useOceanData","component","uri","_useState","oceanData","updated","_useState2","_slicedToArray","status","setStatus","date","startTime","split","getOceanData","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_yield$axios$get","data","wrap","_callee$","_context","prev","next","console","log","concat","get","params","origin","format","mode","sent","localStorage","setItem","JSON","stringify","prevState","_objectSpread","update","stop","apply","arguments","ignore"],"sources":["/Users/js/Dev/my-first-reactor/src/components/waves/useOceanData.js"],"sourcesContent":["import { useEffect, useState } from \"react\";\nimport axios from \"axios\";\nimport useCurrentTime from \"../utils/useCurrentTime.js\";\n\nconst useOceanData = (component, uri) => {\n  const [status, setStatus] = useState({\n    oceanData: {},\n    updated: false,\n  });\n  const date = useCurrentTime()[0].startTime.split(\"%\")[0];\n  const getOceanData = async () => {\n    console.log(`getOceanData => SERVER: ${component}`);\n    //console.log(`getOceanData => SERVER: ${component}\\nuri: ${uri}`);\n    const { data } = await axios.get(uri, {\n      params: {\n        origin: \"*\",\n        format: \"json\",\n        mode: \"cors\",\n      },\n    });\n    //console.log(`getOceanData => SERVER: ${component}: \\nstatus.updated: ${status.updated}\\nuri: ${uri}\\noceanData: ${JSON.stringify(data, null, 2)}`)\n    //console.log(`getOceanData => data.data: ${JSON.stringify(data.data, null, 2)}`)\n    //const lastElement = data.data[data.data.length-1];\n    //console.log(`getOceanData => data.data[last]: ${JSON.stringify(lastElement)}`)\n    //console.log(`getOceanData => data.data[last].v: ${lastElement.v}`)\n    //console.log(`getOceanData => data.data[last].dr: ${lastElement.dr}`)\n    //console.log(`getOceanData => data.data[last].t: ${lastElement.t}`)\n    //console.log(`getOceanData => data.data[last].d: ${lastElement.d}`)\n    //console.log(`getOceanData => data.data[last].g: ${lastElement.g}`)\n\n    localStorage.setItem(`${component}Data`, JSON.stringify(data));\n    localStorage.setItem(`${component}Date`, date);\n    setStatus((prevState) => ({\n      ...prevState,\n      oceanData: data,\n      update: true,\n    }));\n  };\n  useEffect(() => {\n    //console.log(`OceanData => ${ component }`)\n    let ignore = false;\n    //console.log(`useOceanData => CHECK\\nstatus.oceanData: ${JSON.stringify(status.oceanData,null,2)}\\ndate: ${date}`)\n    if (!ignore && JSON.stringify(status.oceanData) === \"{}\") {\n      getOceanData();\n    }\n    return () => {\n      ignore = true;\n    };\n  }, []);\n\n  return [status.oceanData, getOceanData];\n};\nexport default useOceanData;\n\n\n"],"mappings":"+dAAA,OAASA,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAC3C,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,MAAO,CAAAC,cAAc,KAAM,4BAA4B,CAEvD,GAAM,CAAAC,YAAY,CAAG,QAAf,CAAAA,YAAYA,CAAIC,SAAS,CAAEC,GAAG,CAAK,CACvC,IAAAC,SAAA,CAA4BN,QAAQ,CAAC,CACnCO,SAAS,CAAE,CAAC,CAAC,CACbC,OAAO,CAAE,KACX,CAAC,CAAC,CAAAC,UAAA,CAAAC,cAAA,CAAAJ,SAAA,IAHKK,MAAM,CAAAF,UAAA,IAAEG,SAAS,CAAAH,UAAA,IAIxB,GAAM,CAAAI,IAAI,CAAGX,cAAc,CAAC,CAAC,CAAC,CAAC,CAAC,CAACY,SAAS,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CACxD,GAAM,CAAAC,YAAY,6BAAAC,IAAA,CAAAC,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAAG,SAAAC,QAAA,MAAAC,gBAAA,CAAAC,IAAA,QAAAJ,mBAAA,GAAAK,IAAA,UAAAC,SAAAC,QAAA,iBAAAA,QAAA,CAAAC,IAAA,CAAAD,QAAA,CAAAE,IAAA,SACnBC,OAAO,CAACC,GAAG,4BAAAC,MAAA,CAA4B3B,SAAS,CAAE,CAAC,CACnD;AAAAsB,QAAA,CAAAE,IAAA,SACuB,CAAA3B,KAAK,CAAC+B,GAAG,CAAC3B,GAAG,CAAE,CACpC4B,MAAM,CAAE,CACNC,MAAM,CAAE,GAAG,CACXC,MAAM,CAAE,MAAM,CACdC,IAAI,CAAE,MACR,CACF,CAAC,CAAC,QAAAd,gBAAA,CAAAI,QAAA,CAAAW,IAAA,CANMd,IAAI,CAAAD,gBAAA,CAAJC,IAAI,CAOZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEAe,YAAY,CAACC,OAAO,IAAAR,MAAA,CAAI3B,SAAS,SAAQoC,IAAI,CAACC,SAAS,CAAClB,IAAI,CAAC,CAAC,CAC9De,YAAY,CAACC,OAAO,IAAAR,MAAA,CAAI3B,SAAS,SAAQS,IAAI,CAAC,CAC9CD,SAAS,CAAC,SAAC8B,SAAS,SAAAC,aAAA,CAAAA,aAAA,IACfD,SAAS,MACZnC,SAAS,CAAEgB,IAAI,CACfqB,MAAM,CAAE,IAAI,IACZ,CAAC,CAAC,wBAAAlB,QAAA,CAAAmB,IAAA,MAAAxB,OAAA,GACL,kBA3BK,CAAAL,YAAYA,CAAA,SAAAC,IAAA,CAAA6B,KAAA,MAAAC,SAAA,OA2BjB,CACDhD,SAAS,CAAC,UAAM,CACd;AACA,GAAI,CAAAiD,MAAM,CAAG,KAAK,CAClB;AACA,GAAI,CAACA,MAAM,EAAIR,IAAI,CAACC,SAAS,CAAC9B,MAAM,CAACJ,SAAS,CAAC,GAAK,IAAI,CAAE,CACxDS,YAAY,CAAC,CAAC,CAChB,CACA,MAAO,WAAM,CACXgC,MAAM,CAAG,IAAI,CACf,CAAC,CACH,CAAC,CAAE,EAAE,CAAC,CAEN,MAAO,CAACrC,MAAM,CAACJ,SAAS,CAAES,YAAY,CAAC,CACzC,CAAC,CACD,cAAe,CAAAb,YAAY"},"metadata":{},"sourceType":"module"}